'use strict';

var Sequelize, sequelize, DataTypes, Promise = require('bluebird'), _ = require('lodash'), moment = require('moment');

Sequelize = DataTypes = require('./index.js');
// var db = sequelize = new Sequelize('sequelize_test', 'sequelize_test', 'sequelize_test', {
//   dialect: 'mysql',
//   port: 8999,
var db = sequelize = new Sequelize('sequelize_test', 'postgres', 'postgres', {
  dialect: 'postgres',
//var db = sequelize = new Sequelize('sequelize-test-72', 'sequelize', 'nEGkLma26gXVHFUAHJxcmsrK', {
//   dialect: 'sqlite',
  //dialect: 'mssql',
  //host: 'mssql.sequelizejs.com',
  //port: 11433,
  // dialect: 'sqlite',
  //storage: '/tmp/test.sqlite',
//  timezone: '+05:30',
  define: {
    timestamps: false,
  },
  logging: console.log

});


const Event = sequelize.define('ev_events', {
  'user_id' : Sequelize.INTEGER,
  'event_name' : {
    type : Sequelize.TEXT,
    get : function () {
      console.log('ghet')
      return this.getDataValue('event_name');
    },
    set : function(value){
      console.log('shet')
      this.setDataValue('event_name', value);
    }
  }});


return sequelize.sync({
  force: true,
  logging: console.log
})
  .then(() => {
    return Event.create({
      event_name: 'foo'
    });
  })
  .then(() => {
    return Event.findAll();
  })
  .then((results) => {
    console.log(results.toJSON());
  })
  .then(console.log)
  .finally(() => {
    sequelize.close();
  });
